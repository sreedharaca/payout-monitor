<?php

namespace Katana\JsonParserBundle\Parser;

use Katana\JsonParserBundle\Parser\BaseJsonParser;

class UnicumeJsonParser extends BaseJsonParser
{

//    private $json = '{"id":"440","name":"Auto-pawnshop RU","description":"<br><br><b>Conversion flow:<\/b> CPA - correctly completed application checked by call center\r\n<br><br><b>Forbidden traffic types:<\/b>\r\n<br>Incentivized traffic\r\n<br><br><b> Postclick Period:<\/b> 1 month\r\n<br><br><b> GEO:<\/b>\r\nRussian Federation (Moskovskaya Oblast', Moskva, Tatarstan Respublika, Volgogradskaya Oblast', Yaroslavskaya Oblast')","payout_type":"cpa_flat","protocol":"http_img","expiration_date":"2015-09-18","preview_url":"http:\/\/m.dengizaauto.ru\/","currency":"USD","tracking_url":"http:\/\/go.unicume.com\/aff_c?offer_id=440&aff_id=1628","payout":"8.15","categories":"Services","countries":"Russian Federation","countries_short":"RU"}';

    /**
     * @var string
     */
    private $url = 'http://my.unileadnetwork.com/offers/offers.json?api_key=AFFDUPll3v8lBFjR6NdKYbPdtOEvEv';

    /***
     * @var string
     */
//    private $json = <<<'JSON'
//{"success":true,"rows":35,"total_rows":1,"data":{"offers":[{"id":"886","name":"Aviasales [iPad] RU BY UA KZ","description":null,"payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-11-12","preview_url":"https:\/\/itunes.apple.com\/ru\/app\/aviasales-desevye-aviabilety\/id498958864","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=886&aff_id=1154","payout":"1.00","categories":"iPad","countries":"Russian Federation, Belarus, Ukraine, Kazakhstan","countries_short":"RU, BY, UA, KZ"},{"id":"892","name":"Banda [Android] RU","description":null,"payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-11-12","preview_url":"https:\/\/play.google.com\/store\/apps\/details?id=com.alawar.banda","currency":"USD","tracking_url":"http:\/\/apptracking.katanaads.com\/aff_c?offer_id=892&aff_id=1154","payout":"0.80","categories":"Android","countries":"Russian Federation","countries_short":"RU"},{"id":"752","name":"Big Business Deluxe [iPhone] RU US UK","description":null,"payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-24","preview_url":"https:\/\/itunes.apple.com\/ru\/app\/big-business-deluxe\/id716514727","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=752&aff_id=1154","payout":"1.60","categories":"iPhone","countries":"Russian Federation, United States, United Kingdom","countries_short":"RU, US, UK"},{"id":"370","name":"BINGO Blitz - FREE Bingo + Slots iPad US","description":"The Original, Award-Winning Bingo Game that started it all is now available for iPad, iPhone, and iPod Touch! We&rsquo;re working hard to add in additional rooms, gifting, tournaments, teammates and much more. In the meantime, please enjoy the authentic game that over 14 Million people have already enjoyed on Facebook. FREE! \r\n","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-08-07","preview_url":"https:\/\/itunes.apple.com\/app\/id529996768?mt=8","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=370&aff_id=1154","payout":"0.40","categories":"iPad","countries":"United States","countries_short":"US"},{"id":"372","name":"BINGO Blitz - FREE Bingo + Slots iPhone US","description":"The Original, Award-Winning Bingo Game that started it all is now available for iPad, iPhone, and iPod Touch! We&rsquo;re working hard to add in additional rooms, gifting, tournaments, teammates and much more. In the meantime, please enjoy the authentic game that over 14 Million people have already enjoyed on Facebook. FREE! \r\n","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-08-07","preview_url":"https:\/\/itunes.apple.com\/app\/id529996768?mt=8","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=372&aff_id=1154","payout":"0.40","categories":"iPhone","countries":"United States","countries_short":"US"},{"id":"682","name":"Casino Club by William Hill [iOS] UK Incent","description":"Casino Club by William Hill has been designed for the dedicated Casino player and features classic real money Casino games such as Blackjack and Roulette, plus an amazing array of the hottest Jackpot Slots.\r\n<p>\r\n<b>User Conversion Flow:<\/b> Install and open the game","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-14","preview_url":"https:\/\/itunes.apple.com\/gb\/app\/casino-club-by-william-hill\/id559771256?mt=8","currency":"USD","tracking_url":"http:\/\/apptracking.katanaads.com\/aff_c?offer_id=682&aff_id=1154","payout":"0.80","categories":"iOS","countries":"United Kingdom","countries_short":"UK"},{"id":"796","name":"Castle Clash [Android] RU incent","description":null,"payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-30","preview_url":"https:\/\/play.google.com\/store\/apps\/details?id=com.igg.castleclash_ru","currency":"USD","tracking_url":"http:\/\/apptracking.katanaads.com\/aff_c?offer_id=796&aff_id=1154","payout":"0.30","categories":"Android","countries":"Russian Federation","countries_short":"RU"},{"id":"898","name":"Delivery Club [Android] RU","description":null,"payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-11-12","preview_url":"https:\/\/play.google.com\/store\/apps\/details?id=com.deliveryclub","currency":"USD","tracking_url":"http:\/\/apptracking.katanaads.com\/aff_c?offer_id=898&aff_id=1154","payout":"0.70","categories":"Android","countries":"Russian Federation","countries_short":"RU"},{"id":"466","name":"Dragon Eternity HD [iPad] RU US DE","description":null,"payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-09-02","preview_url":"https:\/\/itunes.apple.com\/ru\/app\/id597373458?mt=8","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=466&aff_id=1154","payout":"2.50","categories":"iPad","countries":"Russian Federation, Germany, United States","countries_short":"RU, DE, US"},{"id":"944","name":"Galaxy Empire [Android] 18 countries","description":"After soaring through space for months, you've finally arrived on an unfamiliar planet with the mission of colonizing it. It's time to build your galaxy empire. \r\n<p>\r\n<b>Conversion flow: <\/b>Install and open the app \r\n<p>\r\n<b>Forbidden traffic types: <\/b>Incentivized traffic","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-11-14","preview_url":"https:\/\/play.google.com\/store\/apps\/details?id=com.tap4fun.ge&hl=ru","currency":"USD","tracking_url":"http:\/\/apptracking.katanaads.com\/aff_c?offer_id=944&aff_id=1154","payout":"1.00","categories":"Android","countries":"Australia, Austria, Belgium, Canada, France, Germany, Israel, Italy, Netherlands, Russian Federation, Spain, Switzerland, United Kingdom, United States, Ukraine, Malaysia, New Zealand, Singapore","countries_short":"AU, AT, BE, CA, FR, DE, IL, IT, NL, RU, ES, CH, UK, US, UA, MY, NZ, SG"},{"id":"706","name":"Galaxy Empire [iOS] CA AU US UK DE FR RU","description":"After soaring through space for months, you've finally arrived on an unfamiliar planet with the mission of colonizing it. It's time to build your galaxy empire. \r\n<p>\r\n<b>Conversion flow: <\/b>Install and open the app \r\n<p>\r\n<b>Forbidden traffic types: <\/b>Incentivized traffic","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-18","preview_url":"https:\/\/itunes.apple.com\/app\/id462506975","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=706&aff_id=1154","payout":"1.90","categories":"iOS","countries":"Russian Federation, Canada, Australia, United States, United Kingdom, Germany, France","countries_short":"RU, CA, AU, US, UK, DE, FR"},{"id":"312","name":"Galaxy Legend - iOS - RU, FR","description":"-A strategy RPG with single and multiplayer dimensions in a galactic battlefield\r\n-Cutting-edge interface, delivering stunning galactic imagery\r\n-A wide and varied fleet, awaiting your command\r\n-Utilize a wide range of tactics to overcome foes near and far\r\n-An intense global arena of players vying for positions of power\r\n-Transform your fleet with numerous upgrades and abilities\r\n-A lush narrative plot waiting to be explored\r\n\r\n<br><b>Conversion flow:<\/br><\/b>Install and open the game<\/br><\/b>\r\n\r\n<br><b>Forbidden traffic types:<\/br><\/b> Incentivized traffic","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-07-12","preview_url":"https:\/\/itunes.apple.com\/us\/app\/galaxy-legend\/id599877646?mt=8","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=312&aff_id=1154","payout":"1.60","categories":"iOS","countries":"Russian Federation, France","countries_short":"RU, FR"},{"id":"562","name":" Game of War - iPad - RU","description":"Fire Age the first truly global online game. Befriend, chat, help, and destroy people from all over the world in this real time game of global conquest!\r\n\r\n\r\n<br><b>Conversion flow:<\/br><\/b>Install and open the game<\/br><\/b>\r\n\r\n<br><b>Forbidden traffic types:<\/br><\/b> Incentivized traffic","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-02","preview_url":"https:\/\/itunes.apple.com\/ru\/app\/game-of-war-fire-age\/id667728512?mt=8","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=562&aff_id=1154","payout":"2.20","categories":"iPad","countries":"Russian Federation","countries_short":"RU"},{"id":"568","name":" Game of War - iPhone - RU","description":"Fire Age the first truly global online game. Befriend, chat, help, and destroy people from all over the world in this real time game of global conquest!\r\n\r\n\r\n<br><b>Conversion flow:<\/br><\/b>Install and open the game<\/br><\/b>\r\n\r\n<br><b>Forbidden traffic types:<\/br><\/b> Incentivized traffic","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-02","preview_url":"https:\/\/itunes.apple.com\/ru\/app\/game-of-war-fire-age\/id667728512?mt=8","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=568&aff_id=1154","payout":"1.90","categories":"iPhone","countries":"Russian Federation","countries_short":"RU"},{"id":"712","name":"Game of War [iOS] US UK CA AU RU","description":"Fire Age the first truly global online game. Befriend, chat, help, and destroy people from all over the world in this real time game of global conquest!\r\n\r\n\r\n<br><b>Conversion flow:<\/br><\/b>Install and open the game<\/br><\/b>\r\n\r\n<br><b>Forbidden traffic types:<\/br><\/b> Incentivized traffic","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-18","preview_url":"https:\/\/itunes.apple.com\/us\/app\/game-of-war-fire-age\/id667728512?mt=8","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=712&aff_id=1154","payout":"2.50","categories":"iOS","countries":"Russian Federation, United States, United Kingdom, Canada, Australia","countries_short":"RU, US, UK, CA, AU"},{"id":"844","name":"House Of Fun [iOS] RU","description":null,"payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-11-06","preview_url":"https:\/\/itunes.apple.com\/ru\/app\/id586634331?mt=8","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=844&aff_id=1154","payout":"2.00","categories":"iOS","countries":"Russian Federation","countries_short":"RU"},{"id":"792","name":"Jungle Heat [iOS] RU","description":"Jungle Heat is a military strategy management game that blends together beautiful graphics and deep and exhilarating gameplay into one amazing package. Mine resources, build up your jungle fortress and assemble the mother of all armies to reign down death and destruction upon your arch enemy General Blood.","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-11-14","preview_url":"https:\/\/itunes.apple.com\/app\/id652136891?mt=8","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=792&aff_id=1154","payout":"1.80","categories":"iOS","countries":"Russian Federation","countries_short":"RU"},{"id":"852","name":"Kayak [iPhone] RU","description":null,"payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-11-07","preview_url":"https:\/\/itunes.apple.com\/ru\/app\/kayak\/id305204535?mt=8","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=852&aff_id=1154","payout":"1.00","categories":"iPhone","countries":"Russian Federation","countries_short":"RU"},{"id":"854","name":"Kayak [iPhone] RU Incentivized","description":null,"payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-11-07","preview_url":"https:\/\/itunes.apple.com\/ru\/app\/kayak\/id305204535?mt=8","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=854&aff_id=1154","payout":"0.60","categories":"iPhone","countries":"Russian Federation","countries_short":"RU"},{"id":"776","name":"Kings Empire (Deluxe) [iOS] RU","description":null,"payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-25","preview_url":"https:\/\/itunes.apple.com\/app\/id500099330","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=776&aff_id=1154","payout":"2.00","categories":"iOS","countries":"Russian Federation","countries_short":"RU"},{"id":"718","name":"Kings Empire [iOS] CA AU US UK DE FR RU","description":"To conquer or be conquered! King&rsquo;s Empire is an epic combat strategy game. Build your city, train your troops, research technologies and battle with thousands of other players online!\r\nBattle to conquer the Capital of each region and take advantages of authority for resource allocations!\r\n<p>\r\n<b>Conversion flow: <\/b>Install and open the app \r\n<p>\r\n<b>Forbidden traffic types: <\/b>Incentivized traffic","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-19","preview_url":"https:\/\/itunes.apple.com\/app\/kings-empire-deluxe\/id500099330","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=718&aff_id=1154","payout":"1.60","categories":"iOS","countries":"Russian Federation, United States, United Kingdom, Canada, Australia, Germany, France","countries_short":"RU, US, UK, CA, AU, DE, FR"},{"id":"670","name":"Live Casino by WH [iPad] UK Incent","description":"William Hill Live Casino is the exciting new way to play your favourite real money games and enjoy a real live casino experience! With our glamorous dealers streamed in live HD video, you can play Roulette, Black Jack, Baccarat and Casino Hold&rsquo;em straight from the Casino floor!\r\n<p>\r\n<b>User Conversion Flow:<\/b> Install and open the game","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-13","preview_url":"https:\/\/itunes.apple.com\/ru\/app\/live-casino-by-william-hill\/id688828054?mt=8","currency":"USD","tracking_url":"http:\/\/apptracking.katanaads.com\/aff_c?offer_id=670&aff_id=1154","payout":"1.20","categories":"iPad","countries":"United Kingdom","countries_short":"UK"},{"id":"512","name":"Localife [Android] RU (incentive)","description":null,"payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-16","preview_url":"https:\/\/play.google.com\/store\/apps\/details?id=ru.localife.android","currency":"USD","tracking_url":"http:\/\/apptracking.katanaads.com\/aff_c?offer_id=512&aff_id=1154","payout":"0.20","categories":"Android","countries":"","countries_short":""},{"id":"866","name":"Lokata [Android] RU","description":null,"payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-11-08","preview_url":"https:\/\/play.google.com\/store\/apps\/details?id=ru.lokata.android","currency":"USD","tracking_url":"http:\/\/apptracking.katanaads.com\/aff_c?offer_id=866&aff_id=1154","payout":"0.40","categories":"Android","countries":"Russian Federation","countries_short":"RU"},{"id":"860","name":"Lokata [iOS] RU","description":null,"payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-11-08","preview_url":"https:\/\/itunes.apple.com\/ru\/app\/lokata-hd-katalogi-i-akcii\/id514581982?mt=8","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=860&aff_id=1154","payout":"0.40","categories":"iOS","countries":"Russian Federation","countries_short":"RU"},{"id":"598","name":"Love and Dragons HD [iPad] RU","description":"Love and Dragons is the newest hidden objects game by Game Insight who created the magnificent Mystery Manor and the mystical Mirrors of Albion. The game takes place in the magical world, where dragons live - in the world of warriors and mages, of love and betrayal, of honor and infamy.\r\n\r\n<br><b>Conversion flow:<\/br><\/b>Install and open the game<\/br><\/b>\r\n\r\n<br><b>Forbidden traffic types:<\/br><\/b> Incentivized traffic","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-03","preview_url":"https:\/\/itunes.apple.com\/ru\/app\/love-and-dragons-hd\/id673056501","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=598&aff_id=1154","payout":"2.00","categories":"iPad","countries":"Russian Federation","countries_short":"RU"},{"id":"236","name":"Mystery Manor [iPad] RU, US, UK, CA, AU, DE, FR","description":"Mystery Manor - popular mobile app for iPad. \r\nIt is a mystery-style hidden objects game. In a mystic mansion, inhabited by strange but lovely people, spooky monsters and funny ghosts you&rsquo;ll have to find hidden objects, unlock new rooms and complete quests. Despite of the great gameplay and premium graphics quality, the game is absolutely free!","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-07-09","preview_url":"https:\/\/itunes.apple.com\/app\/id482546787?mt=8","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=236&aff_id=1154","payout":"2.00","categories":"iPad","countries":"Russian Federation, United Kingdom, United States, Canada, Australia, Switzerland, Germany, France","countries_short":"RU, UK, US, CA, AU, CH, DE, FR"},{"id":"826","name":"Rift Hunter [Android] RU","description":null,"payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-31","preview_url":"https:\/\/play.google.com\/store\/apps\/details?id=com.werewolf.rifthunter","currency":"USD","tracking_url":"http:\/\/apptracking.katanaads.com\/aff_c?offer_id=826&aff_id=1154","payout":"0.90","categories":"Android","countries":"Russian Federation","countries_short":"RU"},{"id":"310","name":"Spartan Wars: Elite Edition iOS RU","description":"Harness the power of mythology&rsquo;s greatest figures as you lead your army of blood-thirsty Spartans toward world domination! The world is waiting for a leader like you.\r\n\r\n<br><b>Conversion flow:<\/br><\/b>Install and open the game<\/br><\/b>\r\n\r\n<br><b>Forbidden traffic types:<\/br><\/b> Incentivized traffic","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-07-12","preview_url":"https:\/\/itunes.apple.com\/app\/id581641031","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=310&aff_id=1154","payout":"1.60","categories":"iOS","countries":"Russian Federation","countries_short":"RU"},{"id":"880","name":"Spartan Wars: Empire of Honors [Android] RU","description":"The Top 10 App In More Than 20 Countries\r\n<br><br>\r\nThe No.1 Epic Mythological Strategy Game\r\n<br><br>\r\nBuild a city of epic proportions, train an army of ruthless soldiers, establish your alliance and unite with thousands of players all over the world. Sparta is waiting for a leader like you.\r\n<br><br>\r\n<b>Conversion flow:<\/br><\/b>Install and open the game<\/br><\/b>\r\n\r\n<br><b>Forbidden traffic types:<\/br><\/b> Incentivized traffic","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-11-08","preview_url":"https:\/\/play.google.com\/store\/apps\/details?id=com.tap4fun.spartanwar","currency":"USD","tracking_url":"http:\/\/apptracking.katanaads.com\/aff_c?offer_id=880&aff_id=1154","payout":"1.00","categories":"Android","countries":"Russian Federation","countries_short":"RU"},{"id":"806","name":"Star Wars Force Collection [Android] RU","description":"New Players! Complete the Prologue and get 1 free draw from the Premium Card Pack!!\r\nHere is what the critics are saying: 148apps - 4\/5 rating; Gamezebo - 4\/5 rating; Modojo - &ldquo;it's a must for both fans of the series and card-collecting enthusiasts.&rdquo;\r\nThanks to our players for your continued support! Take the Force (TM) with you wherever you go with the OFFICIAL Star Wars (TM) card game, STAR WARS (TM): FORCE COLLECTION!\r\n\r\n<br><b>Conversion flow:<\/br><\/b>Install and open the game<\/br><\/b>\r\n\r\n<br><b>Forbidden traffic types:<\/br><\/b> Incentivized traffic\r\n<br>\r\n<b>Daily cap: <\/b>500 conversions","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-30","preview_url":"https:\/\/play.google.com\/store\/apps\/details?id=jp.konami.swfc","currency":"USD","tracking_url":"http:\/\/apptracking.katanaads.com\/aff_c?offer_id=806&aff_id=1154","payout":"1.80","categories":"Android","countries":"Russian Federation","countries_short":"RU"},{"id":"812","name":"Star Wars Force Collection [iOS] RU","description":"New Players! Complete the Prologue and get 1 free draw from the Premium Card Pack!!\r\nHere is what the critics are saying: 148apps - 4\/5 rating; Gamezebo - 4\/5 rating; Modojo - &ldquo;it's a must for both fans of the series and card-collecting enthusiasts.&rdquo;\r\nThanks to our players for your continued support! Take the Force (TM) with you wherever you go with the OFFICIAL Star Wars (TM) card game, STAR WARS (TM): FORCE COLLECTION!\r\n\r\n<br><b>Conversion flow:<\/br><\/b>Install and open the game<\/br><\/b>\r\n\r\n<br><b>Forbidden traffic types:<\/br><\/b> Incentivized traffic\r\n\r\n<b>Daily cap: <\/b>150 conversions","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-30","preview_url":"https:\/\/itunes.apple.com\/app\/star-wars-force-collection\/id586854309","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=812&aff_id=1154","payout":"1.80","categories":"iOS","countries":"Russian Federation","countries_short":"RU"},{"id":"872","name":"Total Conquest [iOS] RU","description":"Sound the call to battle and join legions of players online in a battle to control the Roman Empire! Total Conquest is an exciting and strategic social game where you are a Roman governor developing your own city-state and army. But with Caesar dead, you&rsquo;ll need to join a powerful Legion -- or forge your own -- to defeat your enemies, protect your lands, and reign supreme. Vae victis!\r\n<br><br>\r\nBUILD A MIGHTY ROMAN PROVINCE\r\n<br>&radic; Build and manage your own unique city-state\r\n<br>&radic; Defend your city with Towers, Traps, Walls, Gates and garrisoned units\r\n<br><br>\r\nFIGHT EPIC BATTLES\r\n<br>&radic; Hire, train and upgrade 10 different unit types, each with a specific role\r\n<br>&radic; Take on a challenging solo campaign and develop conquest strategies\r\n<br>&radic; Battle players from around the world and lead your army to victory\r\n<br><br>\r\nFORGE AN UNSTOPPABLE LEGION\r\n<br>&radic; Invite friends from Facebook and Game Center \r\n<br>&radic; Create or join a Legion of powerful players and get reinforcements from the other members\r\n<br>&radic; Coordinate with your allies to win Legion Wars \r\n<br>&radic; Fight to increase your Legion ranking and earn great rewards\r\n<br>&radic; Compare your scores on Game Center or the in-game leaderboard\r\n<br><br>\r\n<br><b>Conversion flow:<\/br><\/b>Install and open the game<\/br><\/b>\r\n\r\n<br><b>Forbidden traffic types:<\/br><\/b> Incentivized traffic","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-11-08","preview_url":"https:\/\/itunes.apple.com\/app\/total-conquest-online-combat\/id529829305?mt=8","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=872&aff_id=1154","payout":"1.00","categories":"iOS","countries":"Russian Federation","countries_short":"RU"},{"id":"676","name":"William Hill Bingo [iOS] UK Incent","description":"Have a flutter on Bingo and your favourite side games with the William Hill Bingo App! Log on and play the full range of online bingo games you play at williamhill.com. You can use your existing online account, or register via the simple form to get started.<p>\r\n<b>User Conversion Flow:<\/b> Install and open the game\r\n<p>\r\n<b>Cap:<\/b> 100 installs per day\r\n<p>\r\n<b>Important restriction:<\/b> age +18","payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-14","preview_url":"https:\/\/itunes.apple.com\/gb\/app\/william-hill-bingo\/id571893255?mt=8","currency":"USD","tracking_url":"http:\/\/apptracking.katanaads.com\/aff_c?offer_id=676&aff_id=1154","payout":"0.80","categories":"iOS","countries":"United Kingdom","countries_short":"UK"},{"id":"730","name":"World at Arms [iOS] RU","description":null,"payout_type":"cpa_flat","protocol":"server","expiration_date":"2014-10-21","preview_url":"https:\/\/itunes.apple.com\/us\/app\/world-at-arms-wage-war-for\/id526713081","currency":"USD","tracking_url":"http:\/\/itunes.apples.com.ru\/aff_c?offer_id=730&aff_id=1154","payout":"1.10","categories":"iOS","countries":"Russian Federation","countries_short":"RU"}]}}
//JSON;

    /***
     * @param null $json
     * @return array
     */
    public function parse( $json = null )
    {
        echo "Unicume parser executed\n";

//        if(!$json){ $json = $this->json; }

        $array = json_decode($json, true);

//        var_dump($array['data']);

        $data = array();
        foreach($array['data']['offers'] as $offer)
        {
            $row = array();
            $row['external_id'] = (int)$offer['id'];
            $row['name'] = strval($offer['name']);
            $row['payout'] = floatval($offer['payout']);
            $row['preview_url'] = $offer['preview_url'];

            /***
             * Страны
             */
            $row['countries'] = array();

            $country_codes = array_map( "trim", explode(',', $offer['countries_short']));
            foreach($country_codes as $country_code)
            {
                $Country = $this->container->get('doctrine')->getRepository('KatanaDictionaryBundle:Country')->findOneByCode($country_code);

                if(is_object($Country)){
                    $row['countries'][] = $Country;
                }
            }

            /***
             * Девайсы
             */
            $row['devices'] = array();

            $devices = array_map( "trim", explode(',', $offer['categories']));
            foreach($devices as $device_name)
            {
                $Device = $this->container->get('doctrine')->getRepository('KatanaDictionaryBundle:Device')->findInString($device_name);

                if(!empty($Device) && is_object($Device)){
                    $row['devices'][] = $Device;
                }
            }

            $data[] = $row;
        }
//        var_dump($data);

        return $data;
    }


}